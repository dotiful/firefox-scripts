location == "chrome://browser/content/browser.xul" && gBrowser.addEventListener("DOMWindowCreated", function (e) {
	if (e.originalTarget instanceof Ci.nsIImageDocument) {
		var sb = new(Components.utils.Sandbox)(e.originalTarget.defaultView.wrappedJSObject);
		sb.window = e.originalTarget.defaultView.wrappedJSObject;
		Components.utils.evalInSandbox("with(window){" + '(function(){var image=document.querySelector("body img:only-child");if(!image)return;document.body.appendChild(document.createElement("style")).innerHTML="img{display:block;position:absolute;margin:auto;top:0;right:0;bottom:0;left:0}body{background-color:#222;margin:0}";window.addEventListener("keypress",function(event){switch(event.keyCode+event.charCode){case 39:if(!image.style.MozTransform)image.style.MozTransform="rotate(90deg)";else if(image.style.MozTransform=="rotate(90deg)")image.style.MozTransform="rotate(180deg)";else if(image.style.MozTransform=="rotate(180deg)")image.style.MozTransform="rotate(270deg)";else image.style.MozTransform="";break;case 37:if(!image.style.MozTransform)image.style.MozTransform="rotate(270deg)";else if(image.style.MozTransform=="rotate(90deg)")image.style.MozTransform="";else if(image.style.MozTransform=="rotate(180deg)")image.style.MozTransform="rotate(90deg)";else image.style.MozTransform="rotate(180deg)";break;case 38:if(!image.zoom)image.zoom=1.1;else image.zoom=image.zoom+0.1;image.style.height=image.naturalHeight*image.zoom;image.style.width=image.naturalWidth*image.zoom;break;case 40:if(!image.zoom)image.zoom=0.9;else image.zoom=image.zoom-0.1?image.zoom-0.1:0.1;image.style.height=image.naturalHeight*image.zoom;image.style.width=image.naturalWidth*image.zoom;break;case 48:image.zoom=0;image.style.height=image.naturalHeight;image.style.width=image.naturalWidth;break;case 49:image.style.height=window.innerHeight-10;image.style.width=image.naturalWidth/(image.naturalHeight/(window.innerHeight-10));if(window.innerWidth<parseInt(image.style.width)){image.style.width=window.innerWidth-10;image.style.height=image.naturalHeight/(image.naturalWidth/(window.innerWidth-10))}image.zoom=parseInt(image.style.width)/image.naturalWidth;break;case 50:document.body.style.backgroundColor=/255/.test(document.body.style.backgroundColor)?"#222":"#fff"}},false)})()' + "}", sb);
	}
}, false)